andrew's modifications

on Andrew branch